info_list <- res[[1]]
empty_el <- sapply(info_list, function(x) dim(x)[1]) == 0
names_empty <- names(empty_el[empty_el])
for (name in names_empty) {
df <- info_list[[name]] %>% dplyr::add_row()
df <- replace(df, is.na(df), "-")
info_list[[name]] <- df
}
name
df <- info_list[[name]] %>% dplyr::add_row()
df
df <- replace(df, is.na(df), "-")
df <- replace(df, is.na(df), "")
df
df <- replace(df, is.na(df), "-")
df <- info_list[[name]] %>% dplyr::add_row()
df <- replace(df, is.na(df), "-")
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
library(bloomr.fleetregister)
res <- get_vessel(id = "SWE000004452", type = 'cfr')
library(bloomr.fleetregister)
library(bloomr.fleetregister)
res <- get_vessel(id = "SWE000004452", type = 'cfr')
library(bloomr.fleetregister)
res <- get_vessel(id = "SWE000004452", type = 'cfr')
View(res)
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
read.table("data/cl_cwp_gear_level1.csv")
read.table("data/cl_cwp_gear_level1.csv", sep = ",")
read.table("data/cl_cwp_gear_level1.csv", sep = ",", header = T)
hull_material_codes <- xlsx::read.xslx("data/MDR_Vessel_Hull_Type.xls", 1)
library(xlsx)
library(xlsx)
hull_material_codes <- readxl::read_excel("data/MDR_Vessel_Hull_Type.xls", 1)
View(hull_material_codes)
segments_codes <- readxl::read_excel("data/MDR_Vessel_Segment.xls", 1)
event_codes <- readxl::read_excel("data/MDR_Vessel_Event.xls", 1)
hull_material_codes <- readxl::read_excel("data/MDR_Vessel_Hull_Type.xls", 1)
segments_codes <- readxl::read_excel("data/MDR_Vessel_Segment.xls", 1)
event_codes <- readxl::read_excel("data/MDR_Vessel_Event.xls", 1)
export_type_codes <- readxl::read_excel("data/MDR_Vessel_Export_Type.xls", 1)
public_aid_codes <- readxl::read_excel("data/MDR_Vessel_Public_Aid_Type.xls", 1)
vessel_info <- res
cfr = names(vessel_info)
info_list <- res[[1]]
empty_el <- sapply(info_list, function(x) dim(x)[1]) == 0
names_empty <- names(empty_el[empty_el])
for (name in names_empty) {
info_list[[name]] <- info_list[[name]] %>% dplyr::add_row()
}
info_list <- info_list[sapply(info_list, function(x) dim(x)[1]) > 0]
names_var <- names(info_list)
names_var
info_list[['hull_material']]
info_list[['hull_material']] <- info_list[['hull_material']] %>% dplyr::left_join(hull_material_codes %>% dplyr::select(Code, EnDescription), by = c("value" = code))
info_list[['hull_material']] <- info_list[['hull_material']] %>% dplyr::left_join(hull_material_codes %>% dplyr::select(Code, EnDescription), by = c("value" = "Code"))
info_list[['hull_material']] <- info_list[['hull_material']] %>% dplyr::left_join(hull_material_codes %>% dplyr::select(Code = as.character(Code), EnDescription), by = c("value" = "Code"))
hull_material_codes %>% dplyr::select(Code = as.character(Code), EnDescription)
hull_material_codes %>% dplyr::select(Code = as.character(Code), EnDescription)
hull_material_codes %>% dplyr::select(as.character(Code), EnDescription)
hull_material_codes %>% dplyr::select(Code, EnDescription)
info_list[['hull_material']] <- info_list[['hull_material']] %>% dplyr::left_join(hull_material_codes %>% dplyr::select(Code = as.numeric(Code), EnDescription), by = c("value" = "Code"))
library(vroom)
vroom("data/MDR_Vessel_Hull_Type.xls")
hull_material_codes <- readxl::v("data/MDR_Vessel_Hull_Type.xls", 1) %>% vroom()
hull_material_codes <- readxl::v("data/MDR_Vessel_Hull_Type.xls", 1) %>% vroom()
hull_material_codes <- readxl::read_excel("data/MDR_Vessel_Hull_Type.xls", 1) %>% vroom()
hull_material_codes <- readxl::read_excel("data/MDR_Vessel_Hull_Type.xls", 1)
hull_material_codes <- readxl::read_excel("data/MDR_Vessel_Hull_Type.xls", 1) %>% dplyr::mutate(Code = as.numeric(Code))
info_list[['hull_material']] <- info_list[['hull_material']] %>% dplyr::left_join(hull_material_codes %>% dplyr::select(Code = as.numeric(Code), EnDescription), by = c("value" = "Code"))
info_list[['hull_material']] <- info_list[['hull_material']] %>% dplyr::left_join(hull_material_codes %>% dplyr::select(Code, EnDescription), by = c("value" = "Code"))
info_list
info_list[['hull_material']] <- info_list[['hull_material']] %>%
dplyr::left_join(hull_material_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
hull_material_codes <- readxl::read_excel("data/MDR_Vessel_Hull_Type.xls", 1) %>% dplyr::mutate(Code = as.numeric(Code))
info_list <- res[[1]]
info_list[['hull_material']] <- info_list[['hull_material']] %>%
dplyr::left_join(hull_material_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
info_list[['hull_material']]
View(segments_codes)
# Segment code
info_list[['segment']] <- info_list[['segment']] %>%
dplyr::left_join(segments_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
info_list[['segment']]
View(event_codes)
# Event code
info_list[['event']] <- info_list[['event']] %>%
dplyr::left_join(event_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
event_codes <- readxl::read_excel("data/MDR_Vessel_Event.xls", 1)
# Event code
info_list[['event']] <- info_list[['event']] %>%
dplyr::left_join(event_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
empty_el <- sapply(info_list, function(x) dim(x)[1]) == 0
names_empty <- names(empty_el[empty_el])
for (name in names_empty) {
info_list[[name]] <- info_list[[name]] %>% dplyr::add_row()
}
info_list <- res[[1]]
empty_el <- sapply(info_list, function(x) dim(x)[1]) == 0
names_empty <- names(empty_el[empty_el])
for (name in names_empty) {
info_list[[name]] <- info_list[[name]] %>% dplyr::add_row()
}
# Hull material code
info_list[['hull_material']] <- info_list[['hull_material']] %>%
dplyr::left_join(hull_material_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Segment code
info_list[['segment']] <- info_list[['segment']] %>%
dplyr::left_join(segments_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Event code
info_list[['event']] <- info_list[['event']] %>%
dplyr::left_join(event_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
info_list[['event']]
names_var
# Event code
info_list[['events']] <- info_list[['events']] %>%
dplyr::left_join(event_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
info_list[['events']]
info_list <- res[[1]]
# Hull material code
info_list[['hull_material']] <- info_list[['hull_material']] %>%
dplyr::left_join(hull_material_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Segment code
info_list[['segment']] <- info_list[['segment']] %>%
dplyr::left_join(segments_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Event code
info_list[['events']] <- info_list[['events']] %>%
dplyr::left_join(event_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
info_list[['events']]
public_aid_codes <- readxl::read_excel("data/MDR_Vessel_Public_Aid_Type.xls", 1)
View(public_aid_codes)
# Public aid code
info_list[['public_aid']] <- info_list[['public_aid']] %>%
dplyr::left_join(public_aid_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
public_aid_codes
info_list[['public_aid']]
names_var
# Public aid code
info_list[['import_export']] <- info_list[['import_export']] %>%
dplyr::left_join(export_type_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
info_list[['import_export']]
info_list <- res[[1]]
# Hull material code
info_list[['hull_material']] <- info_list[['hull_material']] %>%
dplyr::left_join(hull_material_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Segment code
info_list[['segment']] <- info_list[['segment']] %>%
dplyr::left_join(segments_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Event code
info_list[['events']] <- info_list[['events']] %>%
dplyr::left_join(event_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Public aid code
info_list[['public_aid']] <- info_list[['public_aid']] %>%
dplyr::left_join(public_aid_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Import / export code
info_list[['import_export']] <- info_list[['import_export']] %>%
dplyr::left_join(export_type_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescrption) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Import / export code
info_list[['import_export']] <- info_list[['import_export']] %>%
dplyr::left_join(export_type_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
info_list[['import_export']]
info_list <- res[[1]]
# Hull material code
info_list[['hull_material']] <- info_list[['hull_material']] %>%
dplyr::left_join(hull_material_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Segment code
info_list[['segment']] <- info_list[['segment']] %>%
dplyr::left_join(segments_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Event code
info_list[['events']] <- info_list[['events']] %>%
dplyr::left_join(event_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Public aid code
info_list[['public_aid']] <- info_list[['public_aid']] %>%
dplyr::left_join(public_aid_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = paste0(value, " - ", EnDescription)) %>%
dplyr::select(-EnDescription)
# Import / export code
info_list[['import_export']] <- info_list[['import_export']] %>%
dplyr::left_join(export_type_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
empty_el <- sapply(info_list, function(x) dim(x)[1]) == 0
names_empty <- names(empty_el[empty_el])
for (name in names_empty) {
info_list[[name]] <- info_list[[name]] %>% dplyr::add_row()
}
names_var <- names(info_list)
names_var <- gsub('_', ' ', names_var)
names_var <- stringr::str_to_sentence(names_var)
names_var <- replace(names_var, names_var == "Mmsi", "MMSI")
names_var <- replace(names_var, names_var == "Ircs", "IRCS")
names_var <- replace(names_var, names_var == "Uvi", "UVI")
df_repartition <- dplyr::tibble(names = names_var, i_start = NA, i_end = NA)
j = 1
index = 1
for (el in info_list) {
df_repartition$i_start[j] <- index
df_repartition$i_end[j] <- index + nrow(el) - 1
index = index + nrow(el)
j = j +1
}
cfr_info_list <- purrr::imap(info_list, ~cbind(.x, variable = .y))
cfr_info <- purrr::map_dfr(cfr_info_list, ~.x %>% dplyr::mutate(across(everything(), as.character)))
cfr_info <- cfr_info %>%
dplyr::select("Value" = value, "Type" = type, "Order" = order, "Name" = name, "Start date" = start_date, "End date" = end_date)
cfr_info <- replace(cfr_info, is.na(cfr_info), "")
cfr_info <- replace(cfr_info, cfr_info == '2100-12-31', "-")
cfr = names(vessel_info)
table <- cfr_info %>%
kableExtra::kbl(caption = paste('CFR:', cfr[index_cfr])) %>%
kableExtra::kable_styling(bootstrap_options = c("condensed", "responsive"), full_width = F)
for(i in 1:nrow(df_repartition)) {
row <- df_repartition[i,]
table <- table %>%
kableExtra::pack_rows(row$names, row$i_start, row$i_end)
}
table <- cfr_info %>%
# kableExtra::kbl(caption = paste('CFR:', cfr[index_cfr])) %>%
kableExtra::kable_styling(bootstrap_options = c("condensed", "responsive"), full_width = F)
for(i in 1:nrow(df_repartition)) {
row <- df_repartition[i,]
table <- table %>%
kableExtra::pack_rows(row$names, row$i_start, row$i_end)
}
index_cfr = 1
table <- cfr_info %>%
kableExtra::kbl(caption = paste('CFR:', cfr[index_cfr])) %>%
kableExtra::kable_styling(bootstrap_options = c("condensed", "responsive"), full_width = F)
for(i in 1:nrow(df_repartition)) {
row <- df_repartition[i,]
table <- table %>%
kableExtra::pack_rows(row$names, row$i_start, row$i_end)
}
print(table)
vessel_type_codes <- readxl::read_excel("data/MDR_Vessel_Type.xls", 1)
vessel_info <- get_vessel(id, type)
gear_codes <- readxl::read_excel("data/MDR_Gear_Type.xls", 1)
vessel_type_codes <- readxl::read_excel("data/MDR_Vessel_Type.xls", 1)
cfr = names(vessel_info)
index_cfr = 1
View(gear_codes)
# Hull material code
info_list[['fishing_gear']] <- info_list[['fishing_gear']] %>%
dplyr::left_join(gear_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
info_list[['fishing_gear']]
names_var
info_list <- res[[1]]
names_var <- names(info_list)
names_var
vessel_type_codes
# Vessel type code
info_list[['vessel_type']] <- info_list[['vessel_type']] %>%
dplyr::left_join(vessel_type_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
info_list[['vessel_type']]
info_list[['fishing_gear']]
vessel_type_codes
info_list[['vessel_type']]
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
files <- c('MDR_Vessel_Hull_Type.xls',
'MDR_Vessel_Segment.xls',
'MDR_Vessel_Event.xls',
'MDR_Vessel_Export_Type.xls',
'MDR_Vessel_Public_Aid_Type.xls',
'MDR_Gear_Type.xls',
'MDR_Vessel_Type.xls'
)
file_path <- system.file("extdata", "MDR_Vessel_Hull_Type.xls", package = "bloomr.fleetregister")
file_path
file_path <- system.file("extdata", "MDR_Vessel_Hull_Type.xls")
file_path
hull_material_codes <- readxl::read_excel(system.file("extdata", "MDR_Vessel_Hull_Type.xls"), 1) %>% dplyr::mutate(Code = as.numeric(Code))
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
hull_material_codes <- readxl::read_excel(system.file("extdata", "MDR_Vessel_Hull_Type.xls", package = "bloomr.fleetregister"), 1) %>% dplyr::mutate(Code = as.numeric(Code))
segments_codes <- readxl::read_excel(system.file("extdata", "MDR_Vessel_Hull_Type.xls", package = "bloomr.fleetregister"), 1)
event_codes <- readxl::read_excel(system.file("extdata", "MDR_Vessel_Hull_Type.xls", package = "bloomr.fleetregister"), 1)
export_type_codes <- readxl::read_excel(system.file("extdata", "MDR_Vessel_Hull_Type.xls", package = "bloomr.fleetregister"), 1)
public_aid_codes <- readxl::read_excel(system.file("extdata", "MDR_Vessel_Hull_Type.xls", package = "bloomr.fleetregister"), 1)
gear_codes <- readxl::read_excel(system.file("extdata", "MDR_Vessel_Hull_Type.xls", package = "bloomr.fleetregister"), 1)
vessel_type_codes <- readxl::read_excel(system.file("extdata", "MDR_Vessel_Hull_Type.xls", package = "bloomr.fleetregister"), 1)
vessel_info <- get_vessel(id, type)
cfr = names(vessel_info)
index_cfr = 1
# Fishing gear code
info_list[['fishing_gear']] <- info_list[['fishing_gear']] %>%
dplyr::left_join(gear_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Vessel type code
info_list[['vessel_type']] <- info_list[['vessel_type']] %>%
dplyr::left_join(vessel_type_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Hull material code
info_list[['hull_material']] <- info_list[['hull_material']] %>%
dplyr::left_join(hull_material_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Hull material code
info_list[['hull_material']] <- info_list[['hull_material']] %>%
dplyr::left_join(hull_material_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = as.character(value))) %>%
dplyr::select(-EnDescription)
# Segment code
info_list[['segment']] <- info_list[['segment']] %>%
dplyr::left_join(segments_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Event code
info_list[['events']] <- info_list[['events']] %>%
dplyr::left_join(event_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Public aid code
info_list[['public_aid']] <- info_list[['public_aid']] %>%
dplyr::left_join(public_aid_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Import / export code
info_list[['import_export']] <- info_list[['import_export']] %>%
dplyr::left_join(export_type_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
res <- get_vessel(id = "SWE000004452", type = 'cfr')
infol_list <- res[[1]]
# Fishing gear code
info_list[['fishing_gear']] <- info_list[['fishing_gear']] %>%
dplyr::left_join(gear_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Vessel type code
info_list[['vessel_type']] <- info_list[['vessel_type']] %>%
dplyr::left_join(vessel_type_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Hull material code
info_list[['hull_material']] <- info_list[['hull_material']] %>%
dplyr::left_join(hull_material_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = as.character(value))) %>%
dplyr::select(-EnDescription)
# Segment code
info_list[['segment']] <- info_list[['segment']] %>%
dplyr::left_join(segments_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
print(info_list[['segment']])
# Event code
info_list[['events']] <- info_list[['events']] %>%
dplyr::left_join(event_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Public aid code
info_list[['public_aid']] <- info_list[['public_aid']] %>%
dplyr::left_join(public_aid_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
# Import / export code
info_list[['import_export']] <- info_list[['import_export']] %>%
dplyr::left_join(export_type_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
info_list
empty_el <- sapply(info_list, function(x) dim(x)[1]) == 0
names_empty <- names(empty_el[empty_el])
for (name in names_empty) {
info_list[[name]] <- info_list[[name]] %>% dplyr::add_row()
}
info_list
info_list[['public_aid']] %>%
dplyr::left_join(public_aid_codes %>%
dplyr::select(Code, EnDescription), by = c("value" = "Code")) %>%
dplyr::mutate(value = case_when(!is.na(EnDescription) ~ paste0(value, " - ", EnDescription),
.default = value)) %>%
dplyr::select(-EnDescription)
public_aid_codes
library(bloomr.fleetregister)
bloomr.fleetregister::display_vessel(id = "SWE000004452", type = 'cfr')
library(bloomr.fleetregister)
open .
detach("package:bloomr.fleetregister", unload = TRUE)
library(bloomr.fleetregister)
